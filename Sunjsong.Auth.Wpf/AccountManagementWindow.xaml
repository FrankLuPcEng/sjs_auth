<ui:FluentWindow x:Class="Sunjsong.Auth.WpfUI.AccountManagementWindow"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                 xmlns:ui="clr-namespace:Wpf.Ui.Controls;assembly=Wpf.Ui"
                 xmlns:uiMarkup="clr-namespace:Wpf.Ui.Markup;assembly=Wpf.Ui"
                 mc:Ignorable="d"
                 Title="帳號管理"
                 Width="900"
                 Height="640"
                 WindowStartupLocation="CenterOwner"
                 WindowBackdropType="Mica"
                 ExtendsContentIntoTitleBar="True">
    <ui:FluentWindow.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <uiMarkup:ThemesDictionary Theme="Light" />
                <uiMarkup:ControlsDictionary />
                <ResourceDictionary Source="themes/Modern.xaml" />
            </ResourceDictionary.MergedDictionaries>
            <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
        </ResourceDictionary>
    </ui:FluentWindow.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <ui:TitleBar Grid.Row="0" Title="帳號管理" />

        <Grid Grid.Row="1" Margin="12">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <StackPanel Orientation="Horizontal" Margin="0,0,0,0">
                <Button Content="新增" Width="80" Command="{Binding AddCommand}" />
                <Button Content="刪除" Width="80" Margin="8,0,0,0" Command="{Binding DeleteCommand}" />
                <Button Content="重新整理" Width="100" Margin="8,0,0,0" Command="{Binding RefreshCommand}" />
            </StackPanel>

            <DataGrid Grid.Row="1"
                      Margin="0,10,0,0"
                      ItemsSource="{Binding Accounts}"
                      SelectedItem="{Binding Selected, Mode=TwoWay}"
                      AutoGenerateColumns="False"
                      HeadersVisibility="Column"
                      RowHeaderWidth="0"
                      IsReadOnly="False">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="使用者名稱"
                                        Binding="{Binding UserName, UpdateSourceTrigger=PropertyChanged}"
                                        Width="2*" />
                    <DataGridTextColumn Header="顯示名稱"
                                        Binding="{Binding DisplayName, UpdateSourceTrigger=PropertyChanged}"
                                        Width="2*" />
                    <DataGridTextColumn Header="建立時間"
                                        Binding="{Binding CreatedAt, StringFormat=yyyy-MM-dd HH:mm:ss}"
                                        IsReadOnly="True"
                                        Width="1.5*" />
                    <DataGridTextColumn Header="更新時間"
                                        Binding="{Binding UpdatedAt, StringFormat=yyyy-MM-dd HH:mm:ss}"
                                        IsReadOnly="True"
                                        Width="1.5*" />
                </DataGrid.Columns>
            </DataGrid>

            <Grid Grid.Row="2" Margin="0,10,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*" />
                    <ColumnDefinition Width="2*" />
                    <ColumnDefinition Width="2*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <TextBox Grid.Column="0"
                         Height="36"
                         Padding="10,6"
                         Margin="0,0,8,0"
                         Text="{Binding Selected.UserName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                <TextBox Grid.Column="1"
                         Height="36"
                         Padding="10,6"
                         Margin="0,0,8,0"
                         Text="{Binding Selected.DisplayName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                <PasswordBox Grid.Column="2"
                             Height="36"
                             Padding="10,6"
                             Margin="0,0,8,0"
                             x:Name="NewPasswordBox"
                             PasswordChanged="NewPasswordBox_OnPasswordChanged" />

                <Button Grid.Column="3"
                        Content="儲存"
                        Width="80"
                        Command="{Binding SaveCommand}" />
            </Grid>
        </Grid>

        <Border Grid.Row="2" Background="#0F000000" Padding="12,8" BorderBrush="#16000000" BorderThickness="1">
            <TextBlock Text="{Binding Status}" />
        </Border>
    </Grid>
</ui:FluentWindow>
